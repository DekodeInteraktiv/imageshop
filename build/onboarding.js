(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React;var a=e.n(t);const n=window.ReactDOM;var o=e.n(n);const s=window.wp.i18n,l=({setStep:e})=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,s.__)("After setup, Imageshop will become your one source of truth for all media on your site.","imageshop-dam-connector")),(0,t.createElement)("div",{className:"imageshop-modal-actions"},(0,t.createElement)("button",{type:"button",className:"button button-primary",onClick:()=>e(2)},(0,s.__)("Start setup","imageshop-dam-connector")),(0,t.createElement)("a",{href:"https://imageshop.no",className:"pull-right",target:"_blank",rel:"noopener noreferrer"},(0,s.__)("Create an account","imageshop-dam-connector")))),r=window.wp.apiFetch;var c=e.n(r);const m=({setStep:e})=>{const[a,n]=(0,t.useState)(""),[o,l]=(0,t.useState)(!1),[r,m]=(0,t.useState)("");return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,s.__)("Enter your API token here. You can find your API token in your ImageShop account.","imageshop-dam-connector")),r&&(0,t.createElement)(t.Fragment,null,o&&(0,t.createElement)("p",{className:"valid-token"},(0,s.__)("✔ Your API token is valid.","imageshop-dam-connector")),!o&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",{className:"invalid-token"},(0,s.__)("❌ Your API token is invalid:","imageshop-dam-connector")),(0,t.createElement)("p",{className:"invalid-token"},r))),(0,t.createElement)("input",{type:"text",value:a,onChange:e=>n(e.target.value)}),(0,t.createElement)("div",{className:"imageshop-modal-actions"},!o&&(0,t.createElement)("button",{type:"button",className:"button button-primary",onClick:()=>{c()({path:"/imageshop/v1/onboarding/token",method:"POST",data:{token:a}}).then((e=>{l(e.valid),m(e.message)})).catch((e=>{l(e.valid),m(e.message)}))}},(0,s.__)("Test API token","imageshop-dam-connector")),o&&(0,t.createElement)("button",{type:"button",className:"button button-primary",onClick:()=>e(3)},(0,s.__)("Continue to upload settings","imageshop-dam-connector"))))},i=window.wp.element,p=window.wp.components,u=({setStep:e})=>{const[a,n]=(0,i.useState)(),[o,l]=(0,i.useState)([]);return(0,t.useEffect)((()=>{c()({path:"/imageshop/v1/onboarding/interfaces"}).then((e=>{const t=[];t.push({value:"",label:(0,s.__)("Select an interface","imageshop-dam-connector")}),e.interfaces.map((e=>{const a={value:e.Id,label:e.Name};t.push(a)})),l(t)}))}),[]),(0,t.useEffect)((()=>{a&&c()({path:"/imageshop/v1/onboarding/interfaces",method:"POST",data:{interface:a}})}),[a]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,s.__)("Interfaces determine where files are stored in your Imageshop account.","imageshop-dam-connector")),(0,t.createElement)(p.SelectControl,{label:(0,s.__)("Select which interface is used for uploaded media files","imageshop-dam-connector"),options:o,onChange:e=>n(e)}),(0,t.createElement)("div",{className:"imageshop-modal-actions"},a&&(0,t.createElement)("button",{type:"button",className:"button button-primary",onClick:()=>e(4)},(0,s.__)("Next step","imageshop-dam-connector"))))},d=({setShowWizard:e,setShowNotice:a})=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,s.__)("Your site has now been configured to use all media via Imageshop.","imageshop-dam-connector")),(0,t.createElement)("div",{className:"imageshop-modal-actions"},(0,t.createElement)("button",{type:"button",className:"button button-primary",onClick:()=>(a(!1),void e(!1))},(0,s.__)("Finish setup","imageshop-dam-connector")))),h=({setShowWizard:e,setShowNotice:a})=>{const[n,o]=(0,t.useState)(1);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"imageshop-modal-overlay"},(0,t.createElement)("div",{className:"imageshop-wizard-wrapper"},(0,t.createElement)("dialog",{className:"imageshop-wizard"},(0,t.createElement)("div",{className:"imageshop-modal-header"},(0,t.createElement)("h2",null,(0,s.__)("Imageshop setup","imageshop-dam-connector")),(0,t.createElement)("button",{type:"button",className:"imageshop-modal-close",onClick:()=>e(!1)},(0,t.createElement)("span",{className:"dashicons dashicons-no"}),(0,t.createElement)("span",{className:"screen-reader-text"},(0,s.__)("Close Imageshop setup modal","imageshop-dam-connector")))),(0,t.createElement)("div",{className:"imageshop-modal-body"},1===n&&(0,t.createElement)(l,{setStep:o}),2===n&&(0,t.createElement)(m,{setStep:o}),3===n&&(0,t.createElement)(u,{setStep:o}),4===n&&(0,t.createElement)(d,{setShowNotice:a,setShowWizard:e}))))))},g=()=>{const[e,a]=(0,t.useState)(!0),[n,o]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{window.addEventListener("keydown",(e=>{"Escape"===e.key&&o(!1)}))}),[]),(0,t.useEffect)((()=>{const e=document.querySelector("body");n?e.classList.add("disable-scroll"):e.classList.remove("disable-scroll")}),[n]),e?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"notice notice-warning inline"},(0,t.createElement)("h2",null,(0,s.__)("Imageshop setup","imageshop-dam-connector")),(0,t.createElement)("p",null,(0,s.__)("The Imageshop integration is almost ready to use, please complete the setup steps to start using Imageshop directly from your media library.","imageshop-dam-connector")),(0,t.createElement)("p",null,(0,t.createElement)("button",{type:"button",className:"button button-primary",onClick:()=>o(!0)},(0,s.__)("Complete setup","imageshop-dam-connector")))),n&&(0,t.createElement)(h,{setShowWizard:o,setShowNotice:a})):(0,t.createElement)(t.Fragment,null)},E=document.getElementById("imageshop-onboarding");E&&o().render((0,t.createElement)(a().StrictMode,null,(0,t.createElement)((()=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(g,null))),null)),E)})();